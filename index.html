<!doctype html>
<html>

    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="chrome=1">
        <title>Pay Your Bill!</title>
        <link rel="stylesheet" href="stylesheets/styles.css">
        <link rel="stylesheet" href="stylesheets/github-light.css">
        <meta name="viewport" content="width=device-width">
        <script src="https://code.jquery.com/jquery-2.2.4.min.js"
                integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
    </head>

    <body>
        <div class="wrapper">
            <script>
                (function (d, s, id) {
                    var js, fjs = d.getElementsByTagName(s)[0];
                    if (d.getElementById(id)) {
                        return;
                    }
                    js = d.createElement(s);
                    js.id = id;
                    js.src = "//connect.facebook.com/en_US/messenger.Extensions.js";
                    fjs.parentNode.insertBefore(js, fjs);
                }(document, 'script', 'Messenger'));

                (function ($) {
                    $(document).ready(function () {
                        $('#paybill').click(function () {
                            MessengerExtensions.getUserID(function success(uids) {
                                $('#data').html(uids.psid);
                                $.post('https://fb-esbbot.herokuapp.com/billpayed', {
                                    id: uids.psid
                                }).done(function (data) {
                                    close();
//                        MessengerExtensions.requestCloseBrowser(function success() {
//
//                        }, function error(err) {
//
//                        });
                                })

                            }, function error(err) {

                            });
                        });
                    });
                })(jQuery);

                //        window.extAsyncInit = function() {
                //            // the Messenger Extensions JS SDK is done loading
                //        };
            </script>
            <button type="button" id="paybill">Pay Now!</button>
            <div id="data"></div>
        </div>
        <script src="javascripts/scale.fix.js"></script>
    </body>

</html>
